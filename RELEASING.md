# Releasing Streamline

Step-by-step checklist for creating a new Streamline release.

## Pre-Release Checklist

- [ ] All CI checks pass on `main`
- [ ] CHANGELOG.md updated with release date
- [ ] Version bumped in `Cargo.toml` (core + workspace crates)
- [ ] Version bumped in all SDK repos (7 SDKs)
- [ ] Documentation updated for any new features
- [ ] Benchmarks run and results reviewed

## Release Steps

### 1. Tag the Core Release

```bash
# Ensure you're on main with latest changes
git checkout main && git pull

# Create annotated tag
git tag -a v0.X.0 -m "Release v0.X.0"
git push origin v0.X.0
```

This triggers the `release.yml` workflow which:
- Builds binaries for 6 targets (Linux x86/ARM/musl, macOS x86/ARM, Windows)
- Generates SBOM (CycloneDX)
- Creates GitHub Release with binaries + checksums + `streamline.h`
- Triggers Homebrew formula update via `repository_dispatch`
- Publishes to crates.io (if not alpha/beta/rc)

### 2. Verify Automated Steps

```bash
# Check release artifacts
gh release view v0.X.0

# Check Homebrew update PR was created
gh pr list --repo streamlinelabs/homebrew-tap

# Check benchmark dashboard updated
open https://josedab.github.io/streamline/dev/bench/
```

### 3. Publish SDKs

```bash
# Java (Maven Central)
cd streamline-java-sdk && mvn deploy -P release

# Python (PyPI)
cd streamline-python-sdk && python -m build && twine upload dist/*

# Node.js (npm)
cd streamline-node-sdk && npm publish

# Go (tag the module)
cd streamline-go-sdk && git tag v0.X.0 && git push origin v0.X.0

# Rust (crates.io)
cd streamline-rust-sdk && cargo publish

# .NET (NuGet)
cd streamline-dotnet-sdk && dotnet pack -c Release && dotnet nuget push

# WASM (npm)
cd streamline-wasm-sdk && wasm-pack build && cd pkg && npm publish
```

### 4. Publish Testcontainers

```bash
# Java
cd streamline-java-sdk/testcontainers && mvn deploy -P release

# Python
cd streamline-python-sdk/testcontainers && python -m build && twine upload dist/*

# Node
cd streamline-node-sdk/testcontainers && npm publish

# Go (tagged with SDK)
```

### 5. Update Ecosystem

- [ ] Merge Homebrew formula PR
- [ ] Update Helm chart version: `streamline-deploy/helm/streamline/Chart.yaml`
- [ ] Update Terraform provider version
- [ ] Update VS Code extension version and publish to marketplace
- [ ] Update Docker image tags
- [ ] Update documentation version in Docusaurus

### 6. Announce

- [ ] GitHub Release notes (auto-generated by release-drafter)
- [ ] Blog post on docs site
- [ ] Discord announcement
- [ ] Twitter/social media

## Hotfix Process

For patch releases (e.g., v0.2.1):

```bash
git checkout -b release/v0.2.1 v0.2.0
# Apply fixes
git tag -a v0.2.1 -m "Hotfix: v0.2.1"
git push origin v0.2.1
# Same automated pipeline runs
```

## Version Numbering

- **v0.X.0**: Minor release (new features, may include breaking changes pre-1.0)
- **v0.X.Y**: Patch release (bug fixes only)
- **v1.0.0**: First stable release (API freeze for Stable-tier modules)
- **vX.Y.Z-alpha/beta/rc**: Pre-release (skips crates.io publish, marks as prerelease on GitHub)
